üöÄ Starting MANAGER E2E Test...
üìß Account: test-manager@test-org-1.com
üè¢ Department: Engineering

============================================================
TEST 1: LOGIN & DASHBOARD
============================================================
‚úÖ Login form filled
‚úÖ Login successful - redirected to dashboard
‚úÖ Dashboard screenshot saved

üìä Checking MANAGER dashboard widgets...
   Found 0 widgets/cards

üîç Expected MANAGER widgets:
   ‚úì Department Overview (Engineering only)
   ‚úì Active Candidates (department-only)
   ‚úì Pending Approvals (offers)
   ‚úì Hiring Pipeline
   ‚úì Team Performance

‚ùå Should NOT see:
   ‚úó Org-wide analytics (ADMIN only)
   ‚úó System health
   ‚úó Usage limits

üîç Console Errors: 2
‚ùå CONSOLE ERRORS FOUND:
   - [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
   - [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)

‚úÖ TEST 1 COMPLETE

============================================================
TEST 2: DEPARTMENT DATA ISOLATION (CRITICAL)
============================================================
‚úÖ Navigated to Candidates page
üìä Candidates visible: 0
‚úÖ No department filter (good - should only see Engineering)

üîç CRITICAL CHECK:
   All candidates MUST be from Engineering department
   NO Sales, Marketing, HR candidates should be visible

‚úÖ TEST 2 COMPLETE

============================================================
TEST 3: CANDIDATE REVIEW
============================================================
‚ö†Ô∏è No candidates found to test detail view

‚úÖ TEST 3 COMPLETE

============================================================
TEST 4: OFFER APPROVAL WORKFLOW
============================================================
‚úÖ Navigated to Offers page
   Approve button visible: False
   Reject button visible: False

üîç CRITICAL CHECK:
   All offers MUST be for Engineering department only
   Cannot approve/reject other departments' offers

‚úÖ TEST 4 COMPLETE

============================================================
TEST 5: DEPARTMENT ANALYTICS
============================================================
‚úÖ Navigated to Analytics page

üîç CRITICAL CHECK:
   Analytics MUST show only Engineering department data
   NO org-wide analytics visible

‚úÖ TEST 5 COMPLETE

============================================================
TEST 6: JOB POSTINGS (LIMITED ACCESS)
============================================================
‚úÖ Navigated to Job Postings page
‚úÖ 'Create Job Posting' button correctly hidden

üîç Expected behavior:
   ‚úÖ Can VIEW job postings
   ‚úÖ Can COMMENT on job postings
   ‚ùå Cannot CREATE job postings
   ‚ùå Cannot DELETE job postings

‚úÖ TEST 6 COMPLETE

============================================================
TEST 7: TEAM VIEW (DEPARTMENT ONLY)
============================================================
‚úÖ Navigated to Team page
üìä Team members visible: 5

üîç CRITICAL CHECK:
   Team list MUST show only Engineering department members
   Cannot see other departments' members
   Cannot change roles (ADMIN only)

‚úÖ TEST 7 COMPLETE

============================================================
TEST 8: RBAC VIOLATION ATTEMPTS
============================================================

üîí Testing restricted URLs...
   ‚ùå Admin panel: ACCESSIBLE (security issue!)
   ‚ùå Org settings: ACCESSIBLE (security issue!)
   ‚ùå Billing: ACCESSIBLE (security issue!)
   ‚ùå User management: ACCESSIBLE (security issue!)
   ‚ùå Super admin: ACCESSIBLE (security issue!)

‚úÖ TEST 8 COMPLETE

============================================================
FINAL CONSOLE ERROR CHECK
============================================================

üìä Total Console Errors: 15

‚ùå CONSOLE ERRORS DETECTED:

First 20 errors:
1. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
2. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
3. Failed to fetch RSC payload for http://localhost:8103/candidates. Falling back to browser navigation. TypeError: Failed to fetch
    at fetchServerResponse (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/client/components/router-reducer/fetch-server-response.js:58:27)
    at InnerLayoutRouter (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/client/components/layout-router.js:305:90)
    at renderWithHooks (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:11121:18)
    at mountIndeterminateComponent (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:16869:13)
    at beginWork$1 (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:18458:16)
    at beginWork (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:26927:14)
    at performUnitOfWork (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:25748:12)
    at workLoopSync (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:25464:5)
    at renderRootSync (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:25419:7)
    at performConcurrentWorkOnRoot (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:24504:74)
    at workLoop (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/scheduler/cjs/scheduler.development.js:256:34)
    at flushWork (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/scheduler/cjs/scheduler.development.js:225:14)
    at MessagePort.performWorkUntilDeadline (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/scheduler/cjs/scheduler.development.js:534:21)
4. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
5. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
6. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
7. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
8. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
9. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
10. Failed to fetch RSC payload for http://localhost:8103/job-postings. Falling back to browser navigation. TypeError: Failed to fetch
    at fetchServerResponse (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/client/components/router-reducer/fetch-server-response.js:58:27)
    at InnerLayoutRouter (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/client/components/layout-router.js:305:90)
    at renderWithHooks (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:11121:18)
    at mountIndeterminateComponent (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:16869:13)
    at beginWork$1 (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:18458:16)
    at beginWork (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:26927:14)
    at performUnitOfWork (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:25748:12)
    at workLoopConcurrent (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:25734:5)
    at renderRootConcurrent (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:25690:9)
    at performConcurrentWorkOnRoot (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/react-dom/cjs/react-dom.development.js:24504:38)
    at workLoop (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/scheduler/cjs/scheduler.development.js:256:34)
    at flushWork (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/scheduler/cjs/scheduler.development.js:225:14)
    at MessagePort.performWorkUntilDeadline (webpack-internal:///(app-pages-browser)/./node_modules/next/dist/compiled/scheduler/cjs/scheduler.development.js:534:21)
11. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
12. [MANAGER DASHBOARD] Load error: Error: Failed to load dashboard
    at loadManagerDashboard (webpack-internal:///(app-pages-browser)/./components/dashboard/ManagerDashboard.tsx:48:23)
13. Failed to load resource: the server responded with a status of 404 (Not Found)
14. Failed to load resource: the server responded with a status of 404 (Not Found)
15. Failed to load resource: the server responded with a status of 404 (Not Found)

üö® ZERO CONSOLE ERROR POLICY VIOLATED!
   errorCount MUST be 0

============================================================
E2E TEST SUMMARY - MANAGER ROLE
============================================================

‚úÖ Tests Completed: 8
üìß Account: test-manager@test-org-1.com
üè¢ Department: Engineering
üì∏ Screenshots: /home/asan/Desktop/ikai/screenshots/w3-manager/
üîç Console Errors: 15

üî¥ CRITICAL VERIFICATION NEEDED:
   1. Department isolation (Engineering only)
   2. Cross-department access blocked
   3. Offer approval scope (Engineering only)
   4. RBAC violations properly blocked
   5. Zero console errors

‚úÖ Test script completed!

‚è∏Ô∏è  Browser kept open for manual inspection...
   Press Enter to close browser and exit...
Traceback (most recent call last):
  File "/home/asan/Desktop/ikai/test-e2e-w3-manager.py", line 385, in <module>
    main()
  File "/home/asan/Desktop/ikai/test-e2e-w3-manager.py", line 380, in main
    input()
EOFError: EOF when reading a line
